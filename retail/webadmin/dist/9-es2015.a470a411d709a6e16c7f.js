(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"18Pu":function(e,t,n){"use strict";n.r(t);var o=n("ofXK"),i=n("tyNb"),c=n("Pn5l"),a=n("PVWW"),s=n("E8I7");class r extends s.a{constructor(){super(...arguments),this.permissions=[]}}var l=n("+gEL"),m=n("sne2"),d=n("IJgu"),u=n("3Pt+"),p=n("fXoL"),b=n("0IaG"),f=n("+0xr"),h=n("/t3+"),g=n("XiUz"),C=n("NFeN"),x=n("bTqV"),y=n("EwFO"),w=n("AITh"),E=n("kmnG"),v=n("qFsG"),D=n("6H7S"),S=n("7syL");function I(e,t){if(1&e&&(p.Vb(0,"div",30),p.Gc(1),p.Ub()),2&e){const e=p.hc(2).$implicit,t=p.hc();p.Cb(1),p.Ic(" ",t.camelToSentenceCase(e)," ")}}function U(e,t){if(1&e&&(p.Vb(0,"div",31),p.Gc(1),p.Ub()),2&e){const e=p.hc(2).$implicit,t=p.hc();p.Cb(1),p.Ic(" ",t.camelToSentenceCase(e)," ")}}function V(e,t){if(1&e&&(p.Vb(0,"mat-header-cell"),p.Ec(1,I,2,1,"div",28),p.Ec(2,U,2,1,"div",29),p.Ub()),2&e){const e=p.hc().$implicit;p.Cb(1),p.nc("ngIf","module"==e),p.Cb(1),p.nc("ngIf","module"!==e)}}function O(e,t){if(1&e&&(p.Vb(0,"div",30),p.Vb(1,"span"),p.Gc(2),p.Ub(),p.Ub()),2&e){const e=p.hc().index,t=p.hc().$implicit,n=p.hc();p.Cb(2),p.Hc(n.modules.controls[e].get(t).value.name)}}function R(e,t){if(1&e&&(p.Tb(0),p.Qb(1,"input",36),p.Sb()),2&e){const e=p.hc(2).index,t=p.hc().$implicit,n=p.hc();p.Cb(1),p.nc("formControl",n.modules.controls[e].get(t))}}function _(e,t){1&e&&p.Qb(0,"input",37)}function k(e,t){if(1&e&&(p.Ec(0,R,2,1,"ng-container",34),p.Ec(1,_,1,0,"ng-template",null,35,p.Fc)),2&e){const e=p.tc(2),t=p.hc().index,n=p.hc().$implicit,o=p.hc();p.nc("ngIf",o.modules.controls[t].get(n))("ngIfElse",e)}}function L(e,t){if(1&e&&(p.Vb(0,"mat-cell"),p.Ec(1,O,3,1,"div",32),p.Vb(2,"div",31),p.Ec(3,k,3,2,"ng-template",null,33,p.Fc),p.Ub(),p.Ub()),2&e){const e=p.tc(4),t=p.hc().$implicit;p.Cb(1),p.nc("ngIf","module"===t)("ngIfElse",e)}}function P(e,t){if(1&e&&(p.Tb(0,25),p.Ec(1,V,3,2,"mat-header-cell",26),p.Ec(2,L,5,2,"mat-cell",27),p.Sb()),2&e){const e=t.$implicit,n=p.hc();p.nc("matColumnDef",e),p.Cb(2),p.nc("matCellDefOf",n.modules.controls)}}function T(e,t){1&e&&p.Qb(0,"mat-header-row")}const F=function(){return{y:"100%"}},M=function(e){return{value:"*",params:e}};function G(e,t){1&e&&p.Qb(0,"mat-row"),2&e&&p.nc("@animate",p.qc(2,M,p.pc(1,F)))}const $=function(){return{delay:"50ms",scale:"0.2"}},A=function(){return{delay:"100ms",x:"-25px"}},j=function(){return{value:"50"}};let N=(()=>{class e extends c.a{constructor(e,t,n){super(n,"Role Management"),this.matDialogRef=e,this.data=t,this.displayedColumns=["module"],this.dataSource=new f.k,this.modulesMapped=[],this.sendResponse=new p.o}ngOnInit(){const e=this.data.permissions.map(e=>e.record_type);this.displayedColumns=this.displayedColumns.concat(e),this._errorEmitService.currentMessage.subscribe(e=>{this.errorType=e.type,this.responseMessage=e.message}),this.roleForm=new u.i({id:new u.f(this.data.role.id),name:new u.f(this.data.role.name,[u.u.required]),description:new u.f(this.data.role.description,[u.u.required]),modules:new u.d([])});const t=this.modules;this.data.modules.forEach(e=>{const n=this.createFormGroup(e);t.push(n)}),this.dataSource.data=this.data.modules}get modules(){return this.roleForm.get("modules")}createControl(e){return new u.f(e||!1)}getFormControl(e,t){return e.get(t)}createFormGroup(e){const t=new u.i({module:new u.f(e)});return e.permissions.forEach(e=>{t.addControl(e.record_type,this.createControl(e.value))}),t}onSubmit(){const e=Object.assign({},this.roleForm.value);let t=[];e.modules.forEach(e=>{const n=this.getCheckedKey(e);n&&n.length>0&&(t=t.concat(n))}),e.permissions=t,this.sendResponse.emit(e)}getCheckedKey(e){const t=Object.keys(e).filter(t=>1==e[t]),n=this.data.modules.find(t=>t.id===e.module.id),o=[];return t.forEach(t=>{const n=e.module.permissions.find(e=>e.record_type==t);o.push({id:n.module_permission_id})}),this.data.role.id&&this.data.role.id.length>0&&n.permissions.forEach(e=>{!o.find(t=>t.id==e.module_permission_id)&&e.value&&o.push({id:e.module_permission_id,_deleted:!0})}),o}camelToSentenceCase(e){return Object(l.a)(e)}}return e.\u0275fac=function(t){return new(t||e)(p.Pb(b.f),p.Pb(b.a),p.Pb(p.s))},e.\u0275cmp=p.Jb({type:e,selectors:[["app-role-form"]],outputs:{sendResponse:"sendResponse"},features:[p.zb],decls:45,vars:22,consts:[[1,"dialog-content-wrapper"],[1,"mat-accent","m-0"],["fxFlex","","fxLayout","row","fxLayoutAlign","space-between center"],["fxLayout","row","fxLayoutAlign","start center",1,"logo","mb-24","mb-md-0"],[1,"logo-icon","mr-12"],[1,"logo-text"],["mat-icon-button","","aria-label","Close dialog",3,"click"],["mat-dialog-content","","fusePerfectScrollbar","",1,"p-24","m-0"],["fxLayout","column","fxLayoutAlign","start","fxFlex","1 0","name","modulesForm","novalidate","",1,"p-24","mr-24",3,"formGroup","ngSubmit"],[3,"type","message"],["fxLayout","row wrap","fxLayout.lt-lg","column","fxLayoutAlign.lt-lg","center","fxLayoutAlign","start center","fxFlex","1 1 auto"],["appearance","outline","fxFlex","100",1,"pr-4"],["matInput","","formControlName","name"],["matSuffix","",1,"secondary-text"],[3,"control"],["matInput","","placeholder","Description","formControlName","description"],["fxLayout","row","fxLayoutAlign","center center",1,"actions"],["matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",2,"width","100%",3,"dataSource"],["table",""],[3,"matColumnDef",4,"ngFor","ngForOf"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],["fxLayout","row","fxLayoutAlign","end center",1,"actions","mb-24"],["type","button","mat-raised-button","","color","secondary","aria-label","Follow",3,"click"],["appPermission","","type","submit","mat-raised-button","","color","accent","aria-label","Send Message",3,"permissions","type","disabled"],[3,"matColumnDef"],[4,"matHeaderCellDef"],[4,"matCellDef","matCellDefOf"],["fxLayout","row","fxLayoutAlign","start start",4,"ngIf"],["fxLayout","row","fxLayoutAlign","center center",4,"ngIf"],["fxLayout","row","fxLayoutAlign","start start"],["fxLayout","row","fxLayoutAlign","center center"],["fxLayout","row","fxLayoutAlign","start start",4,"ngIf","ngIfElse"],["checkboxes",""],[4,"ngIf","ngIfElse"],["nothing",""],["type","checkbox",3,"formControl"],["type","checkbox","disabled",""]],template:function(e,t){1&e&&(p.Vb(0,"div",0),p.Vb(1,"mat-toolbar",1),p.Vb(2,"mat-toolbar-row",2),p.Vb(3,"div",3),p.Vb(4,"mat-icon",4),p.Gc(5," security "),p.Ub(),p.Vb(6,"span",5),p.Gc(7," Roles "),p.Ub(),p.Ub(),p.Vb(8,"button",6),p.dc("click",(function(e){return t.matDialogRef.close()})),p.Vb(9,"mat-icon"),p.Gc(10,"close"),p.Ub(),p.Ub(),p.Ub(),p.Ub(),p.Vb(11,"div",7),p.Vb(12,"form",8),p.dc("ngSubmit",(function(e){return t.onSubmit()})),p.Qb(13,"app-message-box",9),p.Vb(14,"div",10),p.Vb(15,"mat-form-field",11),p.Vb(16,"mat-label"),p.Gc(17,"Name"),p.Ub(),p.Qb(18,"input",12),p.Vb(19,"mat-icon",13),p.Gc(20,"account_circle"),p.Ub(),p.Vb(21,"mat-error"),p.Qb(22,"app-mat-error",14),p.Ub(),p.Ub(),p.Vb(23,"mat-form-field",11),p.Vb(24,"mat-label"),p.Gc(25,"Description"),p.Ub(),p.Qb(26,"textarea",15),p.Vb(27,"mat-icon",13),p.Gc(28,"account_circle"),p.Ub(),p.Vb(29,"mat-error"),p.Qb(30,"app-mat-error",14),p.Ub(),p.Ub(),p.Ub(),p.Qb(31,"hr"),p.Vb(32,"div",16),p.Vb(33,"mat-table",17,18),p.Ec(35,P,3,2,"ng-container",19),p.Ec(36,T,1,0,"mat-header-row",20),p.Ec(37,G,1,4,"mat-row",21),p.Ub(),p.Ub(),p.Qb(38,"br"),p.Vb(39,"div",22),p.Vb(40,"button",23),p.dc("click",(function(e){return t.matDialogRef.close()})),p.Gc(41," Cancel "),p.Ub(),p.Gc(42," \xa0\xa0\xa0 "),p.Vb(43,"button",24),p.Gc(44," Submit "),p.Ub(),p.Ub(),p.Ub(),p.Ub(),p.Ub()),2&e&&(p.Cb(4),p.nc("@animate",p.qc(16,M,p.pc(15,$))),p.Cb(2),p.nc("@animate",p.qc(19,M,p.pc(18,A))),p.Cb(6),p.nc("formGroup",t.roleForm),p.Cb(1),p.nc("type",t.errorType)("message",t.responseMessage),p.Cb(9),p.nc("control",t.roleForm.get("name")),p.Cb(8),p.nc("control",t.roleForm.get("description")),p.Cb(3),p.nc("dataSource",t.dataSource)("@animateStagger",p.pc(21,j)),p.Cb(2),p.nc("ngForOf",t.displayedColumns),p.Cb(1),p.nc("matHeaderRowDef",t.displayedColumns),p.Cb(1),p.nc("matRowDefColumns",t.displayedColumns),p.Cb(6),p.nc("permissions",t.data.userPermissions)("type",t.data.role.id?"edit":"create")("disabled",t.roleForm.invalid))},directives:[h.a,h.c,g.a,g.c,g.b,C.a,x.b,b.d,y.a,u.v,u.q,u.j,w.a,E.c,E.f,v.b,u.c,u.p,u.h,E.g,E.b,D.a,f.j,o.s,f.g,f.i,S.a,f.c,f.e,f.b,f.d,o.t,f.a,u.a,u.g,f.f,f.h],styles:["@media screen and (max-width:599px){.app-role-form{width:100%}}@media screen and (min-width:600px){.app-role-form{width:60%}}.app-role-form .mat-dialog-container{padding:0}.app-role-form .dialog-content-wrapper{max-height:200vh;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.basic-container{padding:5px 30px}"],encapsulation:2,data:{animation:a.a}}),e})();var Q=n("LvDl"),H=n("cp0P"),z=n("vf+8");let q=(()=>{class e{constructor(e){this._networkService=e}getModules(){return this._networkService.getAll(m.f.MODULE)}getRoles(){return this._networkService.getAll(m.f.ROLE)}createRole(e){return this._networkService.post(m.f.ROLE,e)}editRole(e,t){return this._networkService.onUpdate(`${m.f.ROLE}/${e}`,t)}deleteRole(e){return this._networkService.onDelete(`${m.f.ROLE}/${e}`)}forkRolesData(){return Object(H.a)([this.getRoles(),this.getModules(),this.getPermissions()])}getPermissions(){return this._networkService.getAll(m.f.PERMISSION)}getRoleModulePermissions(e){return this._networkService.getAll("ROLE_MODULE_BY_ID",{roleModuleId:e})}}return e.\u0275fac=function(t){return new(t||e)(p.Zb(z.a))},e.\u0275prov=p.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var W=n("B9zo"),J=n("R0Ic"),B=n("LOCc"),K=n("M9IT"),X=n("Dh3D"),Z=n("Qu3c"),Y=n("E7MV");function ee(e,t){if(1&e&&(p.Vb(0,"mat-header-cell"),p.Gc(1),p.Ub()),2&e){const e=p.hc().$implicit,t=p.hc(2);p.Cb(1),p.Hc(t.camelToSentenceCase(e))}}function te(e,t){if(1&e&&(p.Vb(0,"span"),p.Gc(1),p.Ub()),2&e){const e=p.hc().$implicit,t=p.hc().$implicit;p.Cb(1),p.Hc(e[t])}}function ne(e,t){1&e&&(p.Vb(0,"mat-icon",15),p.Gc(1,"done "),p.Ub())}function oe(e,t){1&e&&(p.Vb(0,"mat-icon",16),p.Gc(1,"close"),p.Ub())}function ie(e,t){if(1&e&&(p.Vb(0,"span",12),p.Ec(1,ne,2,0,"mat-icon",13),p.Ec(2,oe,2,0,"mat-icon",14),p.Ub()),2&e){const e=p.hc().$implicit,t=p.hc().$implicit;p.Cb(1),p.nc("ngIf",e[t]),p.Cb(1),p.nc("ngIf",!e[t])}}function ce(e,t){if(1&e&&(p.Vb(0,"mat-cell"),p.Ec(1,te,2,1,"span",10),p.Ec(2,ie,3,2,"ng-template",null,11,p.Fc),p.Ub()),2&e){const e=p.tc(3),t=p.hc().$implicit;p.Cb(1),p.nc("ngIf",t.includes("module"))("ngIfElse",e)}}function ae(e,t){1&e&&(p.Tb(0,7),p.Ec(1,ee,2,1,"mat-header-cell",8),p.Ec(2,ce,4,2,"mat-cell",9),p.Sb()),2&e&&p.nc("matColumnDef",t.$implicit)}function se(e,t){1&e&&p.Qb(0,"mat-header-row")}const re=function(){return{y:"100%"}},le=function(e){return{value:"*",params:e}};function me(e,t){1&e&&p.Qb(0,"mat-row"),2&e&&p.nc("@animate",p.qc(2,le,p.pc(1,re)))}const de=function(){return{value:"50"}};function ue(e,t){if(1&e&&(p.Vb(0,"div"),p.Vb(1,"mat-table",2,3),p.Ec(3,ae,3,1,"ng-container",4),p.Ec(4,se,1,0,"mat-header-row",5),p.Ec(5,me,1,4,"mat-row",6),p.Ub(),p.Ub()),2&e){const e=p.hc();p.Cb(1),p.nc("dataSource",e.dataSource)("@animateStagger",p.pc(5,de)),p.Cb(2),p.nc("ngForOf",e.displayedColumns),p.Cb(1),p.nc("matHeaderRowDef",e.displayedColumns),p.Cb(1),p.nc("matRowDefColumns",e.displayedColumns)}}function pe(e,t){1&e&&(p.Vb(0,"div",17),p.Gc(1," No module assigned to this role\n"),p.Ub())}let be=(()=>{class e extends c.a{constructor(e){super(e),this.title="",this.displayedColumns=["module"],this.dataSource=new f.k}ngOnInit(){this.modules=this._mapperService.makeModulesFlat(Object(Q.cloneDeep)(this.modules));const e=this.permissions.map(e=>e.record_type);this.displayedColumns=this.displayedColumns.concat(e),this.modules.forEach(t=>{t.module=t.name,e.forEach(e=>{t[e]=!!t.permissions.find(t=>t.record_type==e)})}),this.dataSource.data=this.modules}camelToSentenceCase(e){return Object(l.a)(e)}}return e.\u0275fac=function(t){return new(t||e)(p.Pb(p.s))},e.\u0275cmp=p.Jb({type:e,selectors:[["app-permission"]],inputs:{modules:"modules",permissions:"permissions"},features:[p.zb],decls:2,vars:2,consts:[[4,"ngIf"],["fxLayout","row","fxLayoutAlign","center","class","p-16",4,"ngIf"],["matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",3,"dataSource"],["table",""],[3,"matColumnDef",4,"ngFor","ngForOf"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[3,"matColumnDef"],[4,"matHeaderCellDef"],[4,"matCellDef"],[4,"ngIf","ngIfElse"],["icon",""],[2,"margin-left","5px"],["style","color: green",4,"ngIf"],["matTooltip","No Permission","style","color: red",4,"ngIf"],[2,"color","green"],["matTooltip","No Permission",2,"color","red"],["fxLayout","row","fxLayoutAlign","center",1,"p-16"]],template:function(e,t){1&e&&(p.Ec(0,ue,6,6,"div",0),p.Ec(1,pe,2,0,"div",1)),2&e&&(p.nc("ngIf",t.modules.length>0),p.Cb(1),p.nc("ngIf",t.modules.length<1))},directives:[o.t,f.j,o.s,f.g,f.i,f.c,f.e,f.b,f.d,f.a,C.a,Z.a,f.f,f.h,g.c,g.b],styles:["[_nghost-%COMP%] {\n                width: 100%;\n                padding: 10px;\n            }"],data:{animation:a.a}}),e})();function fe(e,t){if(1&e&&(p.Vb(0,"mat-header-cell"),p.Gc(1),p.Ub()),2&e){const e=p.hc().$implicit,t=p.hc();p.Cb(1),p.Hc(e.includes("Icon")?"Modules":t.camelToSentenceCase(e))}}function he(e,t){if(1&e){const e=p.Wb();p.Vb(0,"mat-icon",18),p.dc("click",(function(t){p.xc(e);const n=p.hc(3).$implicit;return p.hc(2).toggleExpandableSymbol(n.id)})),p.Gc(1),p.Ub()}if(2&e){const e=p.hc(3).$implicit,t=p.hc(2);p.Cb(1),p.Ic(" ",t.expandedId==e.id?"keyboard_arrow_up":" keyboard_arrow_down"," ")}}function ge(e,t){if(1&e){const e=p.Wb();p.Vb(0,"mat-icon",19),p.dc("click",(function(t){p.xc(e);const n=p.hc(3).$implicit;return p.hc(2).toggleExpandableSymbol(n.id)})),p.Ub()}}function Ce(e,t){if(1&e&&(p.Tb(0),p.Ec(1,he,2,1,"mat-icon",16),p.Ec(2,ge,1,0,"mat-icon",17),p.Sb()),2&e){const e=p.hc(3).$implicit;p.Cb(1),p.nc("ngIf","expandIcon"===e),p.Cb(1),p.nc("ngIf","expandIcon"===e)}}function xe(e,t){if(1&e){const e=p.Wb();p.Tb(0),p.Vb(1,"mat-icon",20),p.dc("click",(function(t){p.xc(e);const n=p.hc(2).$implicit;return p.hc(2).onDelete(n.id)})),p.Gc(2,"delete"),p.Ub(),p.Gc(3," \xa0\xa0 "),p.Vb(4,"mat-icon",21),p.dc("click",(function(t){p.xc(e);const n=p.hc(2).$implicit;return p.hc(2).onEdit(n)})),p.Gc(5,"mode_edit"),p.Ub(),p.Sb()}if(2&e){const e=p.hc(4);p.Cb(1),p.nc("permissions",e.userPermissions)("type","delete")}}function ye(e,t){if(1&e&&(p.Vb(0,"span"),p.Ec(1,Ce,3,2,"ng-container",15),p.Ec(2,xe,6,2,"ng-container",15),p.Ub()),2&e){const e=p.hc(2).$implicit;p.Cb(1),p.nc("ngIf",e.includes("Icon")),p.Cb(1),p.nc("ngIf",e.includes("action"))}}function we(e,t){if(1&e&&(p.Tb(0),p.Gc(1),p.Sb()),2&e){const e=p.hc(3).$implicit,t=p.hc().$implicit,n=p.hc();p.Cb(1),p.Ic(" ",e[n.camelToSnakeCase(t)]," ")}}function Ee(e,t){if(1&e&&(p.Vb(0,"span"),p.Ec(1,we,2,1,"ng-container",11),p.Ub()),2&e){p.hc(2);const e=p.tc(7),t=p.hc().$implicit,n=p.hc();p.Cb(1),p.nc("ngIf",n.camelToSnakeCase(t).indexOf("created")<0)("ngIfElse",e)}}function ve(e,t){if(1&e&&p.Ec(0,Ee,2,2,"span",11),2&e){const e=p.hc().$implicit,t=p.tc(5),n=p.hc().$implicit,o=p.hc();p.nc("ngIf",e[o.camelToSnakeCase(n)])("ngIfElse",t)}}function De(e,t){1&e&&p.Qb(0,"app-default-text")}function Se(e,t){if(1&e&&(p.Gc(0),p.ic(1,"date")),2&e){const e=p.hc().$implicit,t=p.hc().$implicit,n=p.hc();p.Ic(" ",p.kc(1,1,e[n.camelToSnakeCase(t)],"mediumDate")," ")}}function Ie(e,t){if(1&e&&(p.Vb(0,"mat-cell"),p.Ec(1,ye,3,2,"span",11),p.Ec(2,ve,1,2,"ng-template",null,12,p.Fc),p.Ec(4,De,1,0,"ng-template",null,13,p.Fc),p.Ec(6,Se,2,4,"ng-template",null,14,p.Fc),p.Ub()),2&e){const e=p.tc(3),t=p.hc().$implicit;p.Cb(1),p.nc("ngIf",t.includes("Icon")||t.includes("action"))("ngIfElse",e)}}function Ue(e,t){1&e&&(p.Tb(0,9),p.Ec(1,fe,2,1,"mat-header-cell",10),p.Ec(2,Ie,8,2,"mat-cell",3),p.Sb()),2&e&&p.nc("matColumnDef",t.$implicit)}function Ve(e,t){if(1&e&&p.Qb(0,"app-permission",23),2&e){const e=p.hc().$implicit,t=p.hc();p.nc("permissions",t.permissions)("modules",e.modules)}}function Oe(e,t){if(1&e&&(p.Vb(0,"mat-cell"),p.Ec(1,Ve,1,2,"app-permission",22),p.Ub()),2&e){const e=t.$implicit,n=p.hc();p.nc("@expandableRow",e.id===n.expandedId?"expanded":"collapsed"),p.Cb(1),p.nc("ngIf",n.expandedId==e.id)}}function Re(e,t){1&e&&p.Qb(0,"mat-header-row")}function _e(e,t){1&e&&p.Qb(0,"mat-row")}function ke(e,t){1&e&&p.Qb(0,"mat-row",24)}const Le=function(){return["expandedDetail"]};let Pe=(()=>{class e extends c.a{constructor(e,t){super(t,"Role Management"),this._matDialog=e,this.delete=new p.o,this.edit=new p.o,this.pageSize=B.a.PAGE_SIZE,this.pageSizeOptions=B.a.PAGE_SIZE_OPTIONS,this.expandedId="",this.dataSource=new f.k}ngOnChanges(e){e.roles.currentValue!=e.roles.previousValue&&(this.dataSource=new f.k(this.roles),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort)}toggleExpandableSymbol(e){this.expandedId=this.expandedId===e?"":e}displayName(e,t){return Object(l.d)(e,"name",t)}camelToSnakeCase(e){return Object(l.c)(e)}camelToSentenceCase(e){return Object(l.a)(e)}onDelete(e){this.delete.emit(e)}onEdit(e){this.edit.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(p.Pb(b.b),p.Pb(p.s))},e.\u0275cmp=p.Jb({type:e,selectors:[["app-table-row"]],viewQuery:function(e,t){var n;1&e&&(p.Lc(K.a,!0),p.Lc(X.a,!0)),2&e&&(p.sc(n=p.ec())&&(t.paginator=n.first),p.sc(n=p.ec())&&(t.sort=n.first))},inputs:{roles:"roles",displayedColumns:"displayedColumns",permissions:"permissions"},outputs:{delete:"delete",edit:"edit"},features:[p.zb,p.Ab()],decls:10,vars:9,consts:[["multiTemplateDataRows","",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","expandedDetail"],[4,"matCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],["class","expandable-row",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageIndex","pageSize","pageSizeOptions"],["paginator",""],[3,"matColumnDef"],[4,"matHeaderCellDef"],[4,"ngIf","ngIfElse"],["columns",""],["defaultText",""],["date",""],[4,"ngIf"],["matTooltip","Explore",3,"click",4,"ngIf"],["matTooltip","Close",3,"click",4,"ngIf"],["matTooltip","Explore",3,"click"],["matTooltip","Close",3,"click"],["appPermission","","matTooltip","Delete user","color","warn","type","button",3,"permissions","type","click"],["type","button","matTooltip","Edit user",3,"click"],[3,"permissions","modules",4,"ngIf"],[3,"permissions","modules"],[1,"expandable-row"]],template:function(e,t){1&e&&(p.Vb(0,"div"),p.Vb(1,"mat-table",0),p.Ec(2,Ue,3,1,"ng-container",1),p.Tb(3,2),p.Ec(4,Oe,2,2,"mat-cell",3),p.Sb(),p.Ec(5,Re,1,0,"mat-header-row",4),p.Ec(6,_e,1,0,"mat-row",5),p.Ec(7,ke,1,0,"mat-row",6),p.Ub(),p.Qb(8,"mat-paginator",7,8),p.Ub()),2&e&&(p.Cb(1),p.nc("dataSource",t.dataSource),p.Cb(1),p.nc("ngForOf",t.displayedColumns),p.Cb(3),p.nc("matHeaderRowDef",t.displayedColumns),p.Cb(1),p.nc("matRowDefColumns",t.displayedColumns),p.Cb(1),p.nc("matRowDefColumns",p.pc(8,Le)),p.Cb(1),p.nc("pageIndex",0)("pageSize",t.pageSize)("pageSizeOptions",t.pageSizeOptions))},directives:[f.j,o.s,f.c,f.b,f.g,f.i,K.a,f.e,f.d,f.a,o.t,C.a,Z.a,S.a,Y.a,be,f.f,f.h],pipes:[o.f],styles:["div[_ngcontent-%COMP%]{margin:12px 10px}.mat-table[_ngcontent-%COMP%]{background-color:inherit}.mat-table[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{position:relative;top:4px;cursor:pointer}.mat-table[_ngcontent-%COMP%]   .mat-icon.active[_ngcontent-%COMP%]{-webkit-transform:rotate(90deg);transform:rotate(90deg);margin-left:-8px}.expandable-row[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.1);background-color:#fafafa;min-height:0;overflow:hidden}"],data:{animation:[Object(J.p)("expandableRow",[Object(J.m)("collapsed, void",Object(J.n)({height:"0px",visibility:"hidden"})),Object(J.m)("expanded",Object(J.n)({"min-height":"48px",height:"*",visibility:"visible"})),Object(J.o)("expanded <=> collapsed, void <=> *",Object(J.e)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),e})();const Te=function(){return{delay:"50ms",scale:"0.2"}},Fe=function(e){return{value:"*",params:e}},Me=function(){return{delay:"100ms",x:"-25px"}},Ge=[{path:"",component:(()=>{class e extends c.a{constructor(e,t,n){super(n,"Role Management"),this._matDialog=e,this._service=t,this.modules=[],this.permissions=[],this.displayedColumns=["roleName","description","createdOn","expandIcon","action"]}ngOnInit(){this.roleName=new u.f,this.getData(),this.initSearch()}initSearch(){this.roleName.valueChanges.subscribe(e=>{})}getData(){this._service.forkRolesData().subscribe(e=>{this.roles=e[0];const t=e[1];this.permissions=e[2],this.makeFlat(t,""),this.roles=this.roles.map(e=>Object.assign(Object.assign({},e),{role_name:e.name}))},e=>super.onError(e))}makeFlat(e,t){e.forEach(e=>{this.modules.push(e),e.sub_modules&&this.makeFlat(e.sub_modules,e.name)})}openDialog(e,t){var n=this;this.dialogRef=this._matDialog.open(N,{data:{role:e||new r,userPermissions:this.userPermissions,modules:t||Object(Q.cloneDeep)(this.modules),roles:this.roles,permissions:this.permissions},panelClass:"app-role-form"}).componentInstance.sendResponse.subscribe(e=>{e.id?n.editRole(e):n.createRole(e)})}confirmDialog(e){const t=Object(l.e)(m.c.REMOVE_CONFIRMATION()),n=new d.b("Confirm Action",t);this._matDialog.open(d.a,{data:n,disableClose:!0,panelClass:"app-confirm-dialog",hasBackdrop:!0}).afterClosed().subscribe(t=>{t&&this.onDelete(e)})}onEditHandler(e){let t=Object(Q.cloneDeep)(this.modules);t=t.map(t=>{const n=this.findPermission(e.modules,t.id);return n?(t.permissions=n.permissions.map(e=>Object.assign(Object.assign(Object.assign({},e),{value:!0}),t.permissions.find(t=>t.id==e.id))),t):t}),this.openDialog(e,t)}findPermission(e,t){let n,o;return e.forEach(e=>{if(!o)if(e.id!==t){if(!e.sub_modules)return;const o=this.findPermission(e.sub_modules,t);n=o}else o=!0,n=e}),n}createRole(e){this._service.createRole(e).subscribe(e=>{this.errorType="success",this.responseMessage=m.c.CREATED("Role");const t=Object(Q.cloneDeep)(this.roles);e.role_name=e.name,t.unshift(e),this.roles=t,this.hideMessage(),this._matDialog.closeAll()},e=>{this._errorEmitService.emit(m.c.UNKNOWN(),"error")})}hideMessage(){setTimeout(()=>{this.responseMessage=""},2e3)}editRole(e){this._service.editRole(e.id,e).subscribe(t=>{this.errorType="success",t.role_name=t.name,this.responseMessage=m.c.UPDATED("Role");const n=Object(Q.cloneDeep)(this.roles),o=n.findIndex(t=>t.id==e.id);n[o]=t,this.roles=n,this.hideMessage(),this._matDialog.closeAll()},e=>super.onError(e))}onDelete(e){this._service.deleteRole(e).subscribe(t=>{this.errorType="success",this.hideMessage();const n=this.roles.findIndex(t=>t.id==e),o=Object(Q.cloneDeep)(this.roles);o.splice(n,1),this.roles=o,this.responseMessage=m.c.DELETED("Role")},e=>super.onError(e))}}return e.\u0275fac=function(t){return new(t||e)(p.Pb(b.b),p.Pb(q),p.Pb(p.s))},e.\u0275cmp=p.Jb({type:e,selectors:[["app-role"]],features:[p.zb],decls:20,vars:14,consts:[[1,"page-container","page-layout","carded","fullwidth","inner-scroll"],[1,"top-bg","accent"],[1,"center"],["fxLayout","column","fxLayoutAlign","center center","fxLayout.gt-sm","row","fxLayoutAlign.gt-sm","space-between center",1,"header","accent"],["fxLayout","row","fxLayoutAlign","start center",1,"logo","mb-24","mb-md-0"],[1,"logo-icon","s-32","mr-16"],[1,"logo-text","h1"],[1,"search-wrapper","mx-32","mx-md-0"],["fxFlex","","fxLayout","row","fxLayoutAlign","start center",1,"search"],["name","roleName","placeholder","Search for a role",3,"formControl"],["mat-raised-button","","color","accent",1,"add-product-button","fuse-white","mt-24","mt-md-0",3,"click"],["fusePerfectScrollbar","",1,"content-card"],[3,"type","message"],[3,"roles","permissions","displayedColumns","delete","edit"]],template:function(e,t){1&e&&(p.Vb(0,"div",0),p.Qb(1,"div",1),p.Vb(2,"div",2),p.Vb(3,"div",3),p.Vb(4,"div",4),p.Vb(5,"mat-icon",5),p.Gc(6," settings_applications "),p.Ub(),p.Vb(7,"span",6),p.Gc(8," Roles "),p.Ub(),p.Ub(),p.Vb(9,"div",7),p.Vb(10,"div",8),p.Vb(11,"mat-icon"),p.Gc(12,"search"),p.Ub(),p.Qb(13,"input",9),p.Ub(),p.Ub(),p.Vb(14,"button",10),p.dc("click",(function(e){return t.openDialog(null,null)})),p.Vb(15,"span"),p.Gc(16,"ADD NEW ROLE"),p.Ub(),p.Ub(),p.Ub(),p.Vb(17,"div",11),p.Qb(18,"app-message-box",12),p.Vb(19,"app-table-row",13),p.dc("delete",(function(e){return t.confirmDialog(e)}))("edit",(function(e){return t.onEditHandler(e)})),p.Ub(),p.Ub(),p.Ub(),p.Ub()),2&e&&(p.Cb(5),p.nc("@animate",p.qc(9,Fe,p.pc(8,Te))),p.Cb(2),p.nc("@animate",p.qc(12,Fe,p.pc(11,Me))),p.Cb(6),p.nc("formControl",t.roleName),p.Cb(5),p.nc("type",t.errorType)("message",t.responseMessage),p.Cb(1),p.nc("roles",t.roles)("permissions",t.permissions)("displayedColumns",t.displayedColumns))},directives:[W.a,g.c,g.b,C.a,g.a,u.c,u.p,u.g,x.b,y.a,w.a,Pe],encapsulation:2,data:{animation:a.a}}),e})()}];let $e=(()=>{class e{}return e.\u0275mod=p.Nb({type:e}),e.\u0275inj=p.Mb({factory:function(t){return new(t||e)},imports:[[i.k.forChild(Ge)],i.k]}),e})();var Ae=n("PCNd"),je=n("LPQX"),Ne=n("5HBU"),Qe=n("W/RB");n.d(t,"RoleModule",(function(){return He}));let He=(()=>{class e{}return e.\u0275mod=p.Nb({type:e}),e.\u0275inj=p.Mb({factory:function(t){return new(t||e)},providers:[{provide:E.a,useValue:{appearance:"fill"}}],imports:[[$e,o.c,Ae.a,je.e,Ne.a,Qe.a]]}),e})()}}]);